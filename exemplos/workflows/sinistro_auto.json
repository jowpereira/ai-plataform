{
  "version": "1.0",
  "name": "Pipeline de Sinistro Auto Mapfre",
  "description": "Processamento completo de sinistro de veﾃｭculo: extraﾃｧﾃ｣o, anﾃ｡lise tﾃｩcnica, avaliaﾃｧﾃ｣o de risco e parecer final.",
  "resources": {
    "models": {
      "gpt-4o-mini": {
        "type": "azure-openai",
        "deployment": "gpt-4o-mini"
      }
    },
    "tools": [
      {
        "id": "consultar_tabela_fipe",
        "path": "mock_tools.seguros:consultar_tabela_fipe",
        "description": "Consulta valor FIPE de veﾃｭculos"
      },
      {
        "id": "consultar_apolice",
        "path": "mock_tools.seguros:consultar_apolice",
        "description": "Consulta detalhes de apﾃｳlice de seguro"
      },
      {
        "id": "calcular_score_risco",
        "path": "mock_tools.seguros:calcular_score_risco",
        "description": "Calcula score de risco para anﾃ｡lise de sinistro"
      },
      {
        "id": "gerar_protocolo",
        "path": "mock_tools.seguros:gerar_protocolo",
        "description": "Gera protocolo de atendimento"
      }
    ]
  },
  "agents": [
    {
      "id": "extrator",
      "role": "Extrator de Dados",
      "description": "Extrai informaﾃｧﾃｵes estruturadas do relato de sinistro.",
      "model": "gpt-4o-mini",
      "instructions": "Vocﾃｪ ﾃｩ o Extrator de Dados de Sinistros Auto da Mapfre.\n\nExtraia as seguintes informaﾃｧﾃｵes do relato e retorne em JSON:\n\n```json\n{\n  \"numero_apolice\": \"string ou null\",\n  \"data_sinistro\": \"YYYY-MM-DD\",\n  \"hora_sinistro\": \"HH:MM\",\n  \"local\": {\n    \"endereco\": \"string\",\n    \"cidade\": \"string\",\n    \"uf\": \"string\"\n  },\n  \"veiculo\": {\n    \"marca\": \"string\",\n    \"modelo\": \"string\",\n    \"ano\": \"number\",\n    \"placa\": \"string\"\n  },\n  \"tipo_sinistro\": \"colisao|roubo|furto|incendio|alagamento|outros\",\n  \"descricao\": \"resumo em 2 linhas\",\n  \"terceiros_envolvidos\": true/false,\n  \"vitimas\": true/false,\n  \"boletim_ocorrencia\": \"nﾃｺmero ou null\",\n  \"valor_estimado\": \"number ou null\"\n}\n```\n\nSe nﾃ｣o conseguir extrair algum campo, coloque null.\nNﾃグ invente dados.",
      "tools": []
    },
    {
      "id": "especialista_auto",
      "role": "Especialista Auto",
      "description": "Analisa tecnicamente o sinistro de veﾃｭculo.",
      "model": "gpt-4o-mini",
      "instructions": "Vocﾃｪ ﾃｩ o Especialista em Sinistros Auto da Mapfre.\n\nCom base nos dados extraﾃｭdos, analise:\n\n1. **Cobertura Aplicﾃ｡vel**\n   - Tipo de cobertura contratada\n   - Franquia aplicﾃ｡vel\n   - Exclusﾃｵes relevantes\n\n2. **Anﾃ｡lise Tﾃｩcnica**\n   - Dinﾃ｢mica do acidente\n   - Responsabilidade (segurado/terceiro)\n   - Documentaﾃｧﾃ｣o necessﾃ｡ria\n\n3. **Estimativa de Valor**\n   - Use `consultar_tabela_fipe` para obter valor FIPE\n   - Perda total vs. parcial (perda total se dano > 75% FIPE)\n   - Deduﾃｧﾃ｣o de franquia\n\nFormate sua anﾃ｡lise de forma clara e tﾃｩcnica.",
      "tools": ["consultar_tabela_fipe", "consultar_apolice"]
    },
    {
      "id": "avaliador_risco",
      "role": "Avaliador de Risco",
      "description": "Calcula score de risco e detecta fraudes.",
      "model": "gpt-4o-mini",
      "instructions": "Vocﾃｪ ﾃｩ o Avaliador de Risco da Mapfre.\n\nUse a ferramenta `calcular_score_risco` para calcular o Score de Risco considerando os fatores do sinistro.\n\n**Classificaﾃｧﾃ｣o:**\n- 0-25: BAIXO RISCO - Aprovaﾃｧﾃ｣o automﾃ｡tica\n- 26-50: RISCO MODERADO - Verificaﾃｧﾃ｣o padrﾃ｣o\n- 51-75: RISCO ELEVADO - Anﾃ｡lise aprofundada\n- 76-100: RISCO CRﾃ控ICO - Investigaﾃｧﾃ｣o SIU\n\nFormate o resultado com pontuaﾃｧﾃ｣o detalhada.",
      "tools": ["calcular_score_risco"]
    },
    {
      "id": "resumidor",
      "role": "Gerador de Parecer",
      "description": "Cria parecer executivo final do sinistro.",
      "model": "gpt-4o-mini",
      "instructions": "Vocﾃｪ cria Pareceres Executivos de Sinistros Auto da Mapfre.\n\nCom base nas anﾃ｡lises anteriores, formate o parecer final:\n\n```\n笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武\n                 PARECER DE SINISTRO AUTO\n                      MAPFRE SEGUROS\n笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武\n\n搭 IDENTIFICAﾃﾃグ\n   Protocolo: SIN-AUTO-[YYYYMMDD]-[XXXX]\n   Data/Hora: [data e hora do sinistro]\n   Local: [endereﾃｧo completo]\n\n囓 VEﾃ垢ULO\n   [Marca/Modelo/Ano] - Placa [XXXX]\n   \n投 AVALIAﾃﾃグ\n   Score de Risco: [XX] pontos - [CLASSIFICAﾃﾃグ]\n   Tipo: [PERDA TOTAL / PERDA PARCIAL]\n   \n腸 VALORES\n   FIPE Referﾃｪncia: R$ XX.XXX,XX\n   Indenizaﾃｧﾃ｣o Bruta: R$ XX.XXX,XX\n   Franquia: R$ X.XXX,XX\n   Indenizaﾃｧﾃ｣o Lﾃｭquida: R$ XX.XXX,XX\n\n笨 RECOMENDAﾃﾃグ: [APROVAR / PENDENCIAR / INVESTIGAR / NEGAR]\n\n統 FUNDAMENTAﾃﾃグ\n   [2-3 linhas com justificativa]\n\n搭 PRﾃ店IMOS PASSOS\n   1. [aﾃｧﾃ｣o]\n   2. [aﾃｧﾃ｣o]\n   3. [aﾃｧﾃ｣o]\n\n笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武\n                    PARECER FINALIZADO\n笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武笊絶武\n```",
      "tools": []
    }
  ],
  "workflow": {
    "type": "sequential",
    "steps": [
      {
        "id": "step_extracao",
        "type": "agent",
        "agent": "extrator",
        "input_template": "Extraia os dados do seguinte relato de sinistro:\n\n{{ input }}"
      },
      {
        "id": "step_analise",
        "type": "agent",
        "agent": "especialista_auto",
        "input_template": "Analise tecnicamente o sinistro com os seguintes dados extraﾃｭdos:\n\n{{ step_extracao }}"
      },
      {
        "id": "step_risco",
        "type": "agent",
        "agent": "avaliador_risco",
        "input_template": "Calcule o score de risco para este sinistro:\n\n## Dados Extraﾃｭdos:\n{{ step_extracao }}\n\n## Anﾃ｡lise Tﾃｩcnica:\n{{ step_analise }}"
      },
      {
        "id": "step_parecer",
        "type": "agent",
        "agent": "resumidor",
        "input_template": "Gere o parecer executivo final:\n\n## Dados do Sinistro:\n{{ step_extracao }}\n\n## Anﾃ｡lise Tﾃｩcnica:\n{{ step_analise }}\n\n## Avaliaﾃｧﾃ｣o de Risco:\n{{ step_risco }}"
      }
    ]
  }
}
